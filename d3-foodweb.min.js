!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("d3/d3")):"function"==typeof define&&define.amd?define(["exports","d3/d3"],n):n(t.d3=t.d3||{},t.d3)}(this,function(t,n){"use strict";function e(){function t(t){t.each(function(t,v){function N(){A.stop(),H.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y}),P.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y}),R.attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}),p&&setTimeout(function(){A.restart()},m)}function b(t){n.event.active||A.alphaTarget(.3).restart(),t.fx=t.x,t.fy=t.y}function k(t){t.fx=n.event.x,t.fy=n.event.y}function w(t){n.event.active||A.alphaTarget(0),t.fx=null,t.fy=null}var M=n.select(this).append("svg").attr("width",u).attr("height",f);M.append("rect").attr("x",e).attr("y",a).attr("width",u-e-r).attr("height",f-a-i).attr("fill","white");var A=n.forceSimulation(),L=t.nodes[0],T=t.links1[0],B=t.links2[0],F=n.extent(L,function(t){return t.TL});isNaN(o[0])&&(o[0]=F[0]),isNaN(o[1])&&(o[1]=F[1]);var z=n.extent(L,function(t){return t.B});isNaN(c[0])&&(c[0]=z[0]),isNaN(c[1])&&(c[1]=z[1]);var q=n.scaleLinear().domain([o[0],o[1]]).range([f-i,a]),O=n.axisLeft(q),S=n.scaleSqrt().domain(c).range(l).clamp(!0),_=n.scaleOrdinal().domain([0,1,2,3]).range(["#b3cde3","#ccebc5","#fbb4ae","#decbe4"]).unknown("#ffffff"),G=n.scaleOrdinal().domain([1,2,3,4,5,6,7,8,9,10]).range(n.schemeCategory10),j=n.scaleLinear().domain([0,1]).interpolate(n.interpolateHcl).range([n.rgb("#007AFF"),n.rgb("#FFF500")]);if("cval"in L[0])"number"==typeof s&isNaN(s)&&(s=j);else{for(var C=0;C<L.length;C++)L[C].cval=L[C].type;"number"==typeof s&isNaN(s)&&(s=_)}M.append("g").attr("class","y-axis").attr("transform","translate("+e+", 0)").call(O);var H=M.append("g").attr("class","flinks").selectAll("line").data(T).enter().append("line"),P=M.append("g").attr("class","glinks").selectAll("line").data(B).enter().append("line").attr("stroke",function(t){return G(t.TG-1)}).attr("stroke-width",2),R=M.append("g").attr("class","nodes").selectAll("circle").data(L).enter().append("circle").attr("class","nodecircle").attr("r",function(t){return S(t.B)}).style("fill",function(t){return s(t.cval)}).style("stroke","white").style("stroke-width",.5).call(n.drag().on("start",b).on("drag",k).on("end",w));R.append("title").text(function(t){return t.id});for(var W=n.max(L,function(t){return t.TG}),V=(u-e-r)/(W+1),v=0;v<L.length;v++)"x"in L[v]||(L[v].x=L[v].TG*V+e,L[v].y=q(L[v].TL));A.force("linkflx",n.forceLink().id(function(t){return t.id}).strength(h)).force("linkgrp",n.forceLink().id(function(t){return t.id}).strength(d)).force("charge",n.forceManyBody()).force("centerx",n.forceX().strength(g).x(u/2)).force("trophic",n.forceY().strength(y).y(function(t){return t.type>=4?f/2:q(t.TL)})).force("collide",n.forceCollide().radius(function(t){return S(t.B)+x})),A.nodes(L).on("tick",N),A.force("linkflx").links(T),A.force("linkgrp").links(B)})}var e=50,r=10,a=10,i=10,o=[NaN,NaN],l=[1,50],c=[NaN,NaN],u=960,f=600,s=NaN,h=1e-4,d=.1,y=.9,g=.05,x=10,p=!0,m=0;return t.paddingLeft=function(n){return arguments.length?(e=n,t):e},t.paddingRight=function(n){return arguments.length?(r=n,t):r},t.paddingTop=function(n){return arguments.length?(a=n,t):a},t.paddingBottom=function(n){return arguments.length?(i=n,t):i},t.tllim=function(n){return arguments.length?(o=n,t):o},t.rlim=function(n){return arguments.length?(l=n,t):l},t.blim=function(n){return arguments.length?(c=n,t):c},t.totwidth=function(n){return arguments.length?(u=n,t):u},t.totheight=function(n){return arguments.length?(f=n,t):f},t.colfun=function(n){return arguments.length?(s=n,t):s},t.strengthflxlink=function(n){return arguments.length?(h=n,t):h},t.strengthgrplink=function(n){return arguments.length?(d=n,t):d},t.strengthtrophic=function(n){return arguments.length?(y=n,t):y},t.strengthxcenter=function(n){return arguments.length?(g=n,t):g},t.nodepad=function(n){return arguments.length?(x=n,t):x},t.animating=function(n){return arguments.length?(p=n,t):p},t.animationStep=function(n){return arguments.length?(m=n,t):m},t}function r(){function t(t){t.each(function(t,g){var x=n.select(this).append("svg").attr("width",u).attr("height",f);x.append("rect").attr("x",e).attr("y",a).attr("width",u-e-r).attr("height",f-a-i).attr("fill","white");var p=t.nodes[0],m=t.links1[0],v=(t.links2[0],n.extent(p,function(t){return t.TL}));isNaN(o[0])&&(o[0]=v[0]),isNaN(o[1])&&(o[1]=v[1]);var N=n.extent(p,function(t){return t.B});isNaN(c[0])&&(c[0]=N[0]),isNaN(c[1])&&(c[1]=N[1]);var b=n.scaleLinear().domain([o[0],o[1]]).range([f-i,a]),k=n.axisLeft(b),w=n.scaleSqrt().domain(c).range(l).clamp(!0);isNaN(d)&&(d=n.max(m,function(t){return t.Weight}));var M=n.scalePow().exponent(y).domain([0,d]).range([0,h]),A=(f-a-i)/(o[1]-o[0]),L=n.scaleOrdinal().domain([0,1,2,3]).range(["#b3cde3","#ccebc5","#fbb4ae","#decbe4"]).unknown("#ffffff"),T=n.scaleLinear().domain([0,1]).interpolate(n.interpolateHcl).range([n.rgb("#007AFF"),n.rgb("#FFF500")]);if("cval"in p[0])"number"==typeof s&isNaN(s)&&(s=T);else{for(var B=0;B<p.length;B++)p[B].cval=p[B].type;"number"==typeof s&isNaN(s)&&(s=L)}if(!("cval"in m[0]))for(B=0;B<m.length;B++)for(z=0;z<p.length;z++)m[B].source==p[z].id&&(m[B].cval=p[z].cval);for(var F=n.line().x(function(t){return t.x*A}).y(function(t){return b(t.y)}),B=0;B<m.length;B++){m[B].xy=[];for(var z=0;z<m[B].xpath.length;z++)m[B].xy.push({x:m[B].xpath[z],y:m[B].ypath[z]})}x.append("g").attr("class","y-axis").attr("transform","translate("+e+", 0)").call(k),tipformat=function(t){return"<strong>"+t.id+"</strong><br>B: "+t.B+"<br>TL: "+t.TL};var q=n.select("body").append("div").style("position","absolute").style("z-index","10").style("opacity",0).style("background","lightsteelblue").style("padding","4px").style("font-size","8pt").style("border-radius","4px").html(""),O=x.append("g").attr("class","flinks").selectAll("path").data(m).enter().append("path").attr("fill","none").attr("stroke",function(t){return s(t.cval)}).attr("stroke-width",function(t){return M(t.Weight)}).attr("d",function(t){return F(t.xy)}).attr("opacity",.3),S=x.append("g").attr("class","nodes").selectAll("circle").data(p).enter().append("circle").attr("class","nodecircle").attr("r",function(t){return w(t.B)}).style("fill",function(t){return s(t.cval)}).style("stroke","white").style("stroke-width",.5).attr("cx",function(t){return t.x*A}).attr("cy",function(t){return b(t.y)}).on("mouseover",function(t){S.style("fill","gray").style("opacity",.3),n.select(this).style("fill",function(t){return s(t.cval)}).style("opacity",1),O.style("stroke",function(n){return n.source==t.id?"blue":n.target==t.id?"red":"gray"}).style("opacity",function(n){return n.source==t.id|n.target==t.id?1:.1}),q.style("opacity",.9).style("top",b(t.y)+"px").style("left",t.x*A+w(t.B)+20+"px").html(tipformat(t))}).on("mouseout",function(t){O.style("stroke",function(t){return s(t.cval)}).style("opacity",.3),S.style("opacity",1).style("fill",function(t){return s(t.cval)}),q.style("opacity",0)})})}var e=50,r=10,a=10,i=10,o=[NaN,NaN],l=[1,50],c=[NaN,NaN],u=960,f=600,s=NaN,h=100,d=NaN,y=1/3;return t.paddingLeft=function(n){return arguments.length?(e=n,t):e},t.paddingRight=function(n){return arguments.length?(r=n,t):r},t.paddingTop=function(n){return arguments.length?(a=n,t):a},t.paddingBottom=function(n){return arguments.length?(i=n,t):i},t.tllim=function(n){return arguments.length?(o=n,t):o},t.rlim=function(n){return arguments.length?(l=n,t):l},t.blim=function(n){return arguments.length?(c=n,t):c},t.totwidth=function(n){return arguments.length?(u=n,t):u},t.totheight=function(n){return arguments.length?(f=n,t):f},t.colfun=function(n){return arguments.length?(s=n,t):s},t.lwmax=function(n){return arguments.length?(h=n,t):h},t.wmax=function(n){return arguments.length?(d=n,t):d},t.pedge=function(n){return arguments.length?(y=n,t):y},t}function a(t,e){var r=[],a=[],o=[],l=n.selectAll(".nodecircle"),c=l.nodes(),u=n.select("svg");l.each(function(t,n){var e=u.append("svg:text").attr("x",100).attr("y",100).attr("font-size",fontsz.valueAsNumber).attr("font-family","Arial").text(t.id),i=e.node().getBBox();e.remove();var l=c[n].r.baseVal.value;i.width<=2*l?(o.push({x:t.x,y:t.y,width:i.width,height:i.height,name:t.id}),r.push({x:t.x,y:t.y,width:i.width,height:i.height,name:""}),a.push({x:t.x,y:t.y,r:l})):(r.push({x:t.x,y:t.y,width:i.width,height:i.height,name:t.id}),a.push({x:t.x,y:t.y,r:l}))});var f=n.select(".nodes");f.selectAll(".label1").data(o).enter().append("text").attr("class","inlabel").attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("text-anchor","middle").attr("dy","0.35em").attr("font-size",fontsz.valueAsNumber).attr("font-family","Arial").text(function(t){return t.name}),i().label(r).anchor(a).width(t).height(e).start(1e3),f.selectAll(".label2").data(r).enter().append("text").attr("class","label").attr("text-anchor","start").text(function(t){return t.name}).attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("font-size",fontsz.valueAsNumber).attr("font-family","Arial").attr("fill","black"),f.selectAll(".lbllink").data(r).enter().append("line").attr("class","link").attr("x1",function(t){return t.x}).attr("y1",function(t){return t.y}).attr("x2",function(t,n){return a[n].x}).attr("y2",function(t,n){return a[n].y}).attr("stroke-width",.6).attr("stroke","gray")}var i=function(){var t,n,e=[],r=[],a=1,i=1,o={},l=5,c=.5,u=0,f=0,s=.2,h=1,d=30,y=30,g=3,x=!1,p=!1,m=function(t){var n=e.length,a=0,i=e[t].x-r[t].x,o=r[t].y-e[t].y,l=Math.sqrt(i*i+o*o),c=!0;l>0&&(a+=l*s),i/=l,o/=l,a+=i>0&&o>0?0*g:i<0&&o>0?1*g:i<0&&o<0?2*g:3*g;for(var u,f,x,p,m,v,N,k=e[t].x,w=e[t].y-e[t].height+2,M=e[t].x+e[t].width,A=e[t].y+2,L=0;L<n;L++)L!=t&&(c=b(r[t].x,e[t].x,r[L].x,e[L].x,r[t].y,e[t].y,r[L].y,e[L].y),c&&(a+=h),u=e[L].x,x=e[L].y-e[L].height+2,f=e[L].x+e[L].width,p=e[L].y+2,m=Math.max(0,Math.min(f,M)-Math.max(u,k)),v=Math.max(0,Math.min(p,A)-Math.max(x,w)),N=m*v,a+=N*d),u=r[L].x-r[L].r,x=r[L].y-r[L].r,f=r[L].x+r[L].r,p=r[L].y+r[L].r,m=Math.max(0,Math.min(f,M)-Math.max(u,k)),v=Math.max(0,Math.min(p,A)-Math.max(x,w)),N=m*v,a+=N*y;return a},v=function(n){var o,c=Math.floor(Math.random()*e.length),s=e[c].x,h=e[c].y;o=x?t(c,e,r):m(c),e[c].x+=(Math.random()-.5)*l,e[c].y+=(Math.random()-.5)*l,e[c].x>a&&(e[c].x=s),e[c].x<0&&(e[c].x=s),e[c].y>i&&(e[c].y=h),e[c].y<0&&(e[c].y=h);var d;d=x?t(c,e,r):m(c);var y=d-o;Math.random()<Math.exp(-y/n)?u+=1:(e[c].x=s,e[c].y=h,f+=1)},N=function(n){var o,l=Math.floor(Math.random()*e.length),s=e[l].x,h=e[l].y;o=x?t(l,e,r):m(l);var d=(Math.random()-.5)*c,y=Math.sin(d),g=Math.cos(d);e[l].x-=r[l].x,e[l].y-=r[l].y;var p=e[l].x*g-e[l].y*y,v=e[l].x*y+e[l].y*g;e[l].x=p+r[l].x,e[l].y=v+r[l].y,e[l].x>a&&(e[l].x=s),e[l].x<0&&(e[l].x=s),e[l].y>i&&(e[l].y=h),e[l].y<0&&(e[l].y=h);var N;N=x?t(l,e,r):m(l);var b=N-o;Math.random()<Math.exp(-b/n)?u+=1:(e[l].x=s,e[l].y=h,f+=1)},b=function(t,n,e,r,a,i,o,l){var c,u,f,s,h;return f=(l-o)*(n-t)-(r-e)*(i-a),s=(r-e)*(a-o)-(l-o)*(t-e),h=(n-t)*(a-o)-(i-a)*(t-e),c=s/f,u=h/f,!(c<0||c>1||u<0||u>1)},k=function(t,n,e){return t-n/e};return o.start=function(t){for(var n=e.length,r=1,a=1,i=0;i<t;i++){for(var o=0;o<n;o++)Math.random()<.5?v(r):N(r);r=k(r,a,t)}},o.width=function(t){return arguments.length?(a=t,o):a},o.height=function(t){return arguments.length?(i=t,o):i},o.label=function(t){return arguments.length?(e=t,o):e},o.anchor=function(t){return arguments.length?(r=t,o):r},o.alt_energy=function(n){return arguments.length?(t=n,x=!0,o):m},o.alt_schedule=function(t){return arguments.length?(n=t,p=!0,o):k},o};t.foodweblayout=e,t.foodwebstatic=r,t.labelnodes=a,Object.defineProperty(t,"__esModule",{value:!0})});